<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8">
  <title>Consulta 6 - Cartas com Mais de 100 Usos</title>
  <style>
    /* Seu CSS permanece o mesmo */
    body {
      font-family: Arial, sans-serif;
      padding: 20px;
      background-color: #c4d9e9;
      color: #0b2545;
      text-align: center;
    }
    h1 {
      color: #0b2545;
      margin-bottom: 30px;
    }
    table {
      width: 100%;
      max-width: 1200px;
      margin: 0 auto;
      border-collapse: collapse;
      background-color: white;
      border: 3px solid #f2a100;
      border-radius: 10px;
      overflow: hidden;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
    }
    th, td {
      padding: 12px;
      border: 1px solid #ddd;
      text-align: center;
      color: #0b2545;
    }
    thead {
      background-color: #2563eb;
      color: white;
    }
    tbody tr:nth-child(even) {
      background-color: #f1f5f9;
    }
    tbody tr:hover {
      background-color: #e0f2fe;
    }
    td {
      color: #374151;
    }
    th {
      background-color: #f2a100;
      color: white;
    }
    .voltar-btn {
      display: inline-block;
      margin-top: 25px;
      padding: 10px 20px;
      background-color: #0b2545;
      color: white;
      border: 3px solid #f2a100;
      border-radius: 5px;
      text-decoration: none;
      font-weight: bold;
      transition: background-color 0.3s;
    }
    .voltar-btn:hover {
      background-color: #133b70;
    }
    @media (max-width: 768px) {
      table, thead, tbody, th, td, tr {
        display: block;
      }
      thead {
        display: none;
      }
      tr {
        margin-bottom: 15px;
        background: #fff;
        border: 1px solid #ddd;
        border-radius: 8px;
        padding: 10px;
      }
      td {
        display: flex;
        justify-content: space-between;
        padding: 8px 10px;
        border-bottom: 1px solid #eee;
      }
      td::before {
        content: attr(data-label);
        font-weight: bold;
        color: #6b7280;
      }
    }
  </style>
</head>
<body>
  <h1>Consulta 6 - Cartas com Mais de 100 Usos</h1>
  <table>
    <thead>
      <tr>
        <th>Carta</th>
        <th>Player Tags</th>
        <th>Uso Mínimo</th>
        <th>Taxa de Vitória (%)</th>
        <th>Usos</th>
      </tr>
    </thead>
    <tbody id="dadosConsulta6">
    </tbody>
  </table>

  <a href="index.html" class="voltar-btn">Voltar ao Início</a>

  <script>
    async function carregarConsulta6() {
      try {
        // Fazendo a requisição para o endpoint
        const resposta = await fetch('http://localhost:3000/consulta6');
        
        // Verificando se a resposta foi ok (status 200)
        if (!resposta.ok) {
          console.error("Erro na requisição: ", resposta.statusText);
          return;
        }

        const dados = await resposta.json();

        // Função para converter o nome da carta (em inglês) para o nome em português (minúsculo)
        function getNomeImagem(nomeCarta) {
          const nomesImagens = {
            "Mini P.E.K.K.A": "minipekka",
            "Barbarians": "barbaros",
            "Wizard": "mago",
            "Goblin Hut": "cabana",
            "Zap": "zap",
            "Battle Ram": "ariete",
            "Witch": "bruxa",
            "Mega Minion": "megaservo",
            "Valkyrie": "valquiria",
            "Three Musketeers": "3mosqueteiras",
            "Battle Healer": "curandeira",
            "Freeze": "gelo",
            "Barbarian Hut": "cabanabarbaro",
            "Skeleton Barrel": "barrilesqueletos",
            "Dart Goblin": "goblindardo"
          };
          return nomesImagens[nomeCarta] || nomeCarta.toLowerCase().replace(/ /g, "_");
        }

        // Verificando os dados e criando as linhas da tabela
        if (dados && Array.isArray(dados) && dados.length > 0) {
          const tabela = document.getElementById('dadosConsulta6');

          // Iterando sobre os dados e criando as linhas da tabela
          dados.forEach(item => {
            const cartaImagem = getNomeImagem(item.name) + ".jpeg"; // Formando o nome da imagem
            const linha = document.createElement('tr');
            linha.innerHTML = `
              <td data-label="Carta">
                ${cartaImagem ? `<img src="images/${cartaImagem}" class="carta-imagem" alt="${item.name}" style="width: 50px; height: 50px; object-fit: cover;">` : ""}
                ${item.name}
              </td>
              <td data-label="Player Tags">${item.players_tags.join(', ')}</td>
              <td data-label="Uso Mínimo">${item.min_uses}</td>
              <td data-label="Taxa de Vitória (%)">${(item.winRate * 100).toFixed(2)}%</td>
              <td data-label="Usos">${item.count}</td>
            `;
            tabela.appendChild(linha);
          });
        } else {
          console.log('Nenhum dado encontrado ou dados mal formatados.');
        }
      } catch (erro) {
        console.error("Erro ao carregar dados da Consulta 6:", erro);
      }
    }

    // Chamando a função assim que a página carregar
    window.onload = carregarConsulta6;
  </script>
</body>
</html>
